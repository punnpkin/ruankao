# 03 数据库系统（重要）

## 0. 前言

数据库模式、ER模型、关系代数和元组演算、规范化控制、并发控制、数据库 完整性约束、分布式数据库、数据仓库和数据挖掘

## 1. 三级模式-两级映射

<img src="03_%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F.assets/%E4%B8%89%E7%BA%A7%E6%A8%A1%E5%BC%8F.png" style="zoom:67%;" />

[参考](https://blog.csdn.net/mcb520wf/article/details/91047683)

三级模式

- **用户级**

  外模式，它是某个或某几个用户所看到的数据库的**数据视图**，是与某一应用有关的数据的逻辑表示。外模式是从模式导出的一个子集，包含模式中允许特定用户使用的那部分数据。用户可以通过外模式描述语言来描述、定义对应于用户的数据记录(外模式)，也可以利用**数据操纵语言(Data Manipulation Language，DML)**对这些数据记录进行操作。

- **概念级**

  概念模式：它是由数据库设计者综合所有用户的数据，按照统一的观点构造的全局逻辑结构，是对数据库中全部数据的逻辑结构和特征的总体描述，是所有用户的公共数据视图(全局视图)。它是由数据库管理系统提供的**数据模式描述语言(Data Description Language，DDL)**来描述、定义的。

- **物理级**

  内模式：它是数据库中全体数据的内部表示或底层描述，是数据库最低一级的逻辑描述，它描述了数据在存储介质上的存储方式和物理结构，对应着实际存储在外存储介质上的数据库。内模式由内模式描述语言来描述、定义的。

总之，数据按**外模式的描述提供给用户；按内模式的描述存储在磁盘上；而概念模式提供了连接这两级模式的相对稳定的中间层**，并使得两级中任意一级的改变都不受另一级的牵制。

两级映射

数据库系统在三级模式之间提供了两级映像：模式/内模式的映像、外模式/模式的映像。

- 模式/内模式的映像：实现概念模式到内模式之间的相互转换；
- 外模式/模式的映像：实现外模式到概念模式之间的相互转换。

数据的独立性是指数据与程序独立，将数据的定义从程序中分离出来，由DBMS（数据库管理系统）负责数据的存储，数据的独立性包括数据的**物理独立性**和数据的**逻辑独立性**。

什么是数据的物理独立性？

答：数据的物理独立性是指当**数据库的内模式发生改变时，数据的的逻辑结构不变**。由于应用程序处理的只是数据的逻辑结构，这样物理独立性可以保证，当数据的物理结构改变了，应用程序不用改变。但是，为了保证应用程序能够正确执行，**需要修改概念模式/内模式之间的映像**。

什么是数据的逻辑独立性？

答：数据的逻辑独立性是指**用户的应用程序与数据库结构是相互独立的**。数据的逻辑结构发生变化后，用户程序也可以不修改。但是，为了保证应用程序能够正确执行，**需要修改外模式/概念模式之间的映像**。

## 2. 数据库的设计过程

[参考](https://blog.csdn.net/qq_43333395/article/details/105876760)

1. **需求设计：**分析用户的需求，包括数据、功能和性能需求；
2. **概念结构设计：**主要采用E-R模型进行设计；
3. **逻辑结构设计：**通过将E-R图转换成表，实现从E-R模型到关系模型的转换；
4. **物理结构设计：**主要是为所设计的数据库选择合适的存储结构和存取路径；
5. **数据库实施：**数据库的实施：包括编程、测试和试运行；
6. **数据库的运行和维护：**系统的运行与数据库的日常维护。

## 3. ER图

方框表示**实体**，椭圆表示**属性**，菱形表示**联系**

- 实体：是一个数据对象，指应用中可以区别的客观存在的事物；
- 联系：表示一个或多个实体之间的关联关系；
- 属性：实体的某一特性称为属性。

ER图集成：

- 多个局部ER图一次集成
- 逐步集成：用累加的方式，一次集成两个

属性冲突：

- 属性冲突
- 命名冲突
- 结构冲突

**关系模型：**用二维表的形式表示实体和实体间联系的数据模型

- 关系模型中，字段称为属性，字段值称为属性值；
- 关系模式名是R。记录称为元组，元组的集合称为关系或实例；

**ER模型与关系模型的转化**

- 若实体间的联系是1:1，可以再两个实体类型转换成的两个关系模式中**任意的一个关系模式的属性加入另一个关系模式的键和联系类型的属性**。
- 若实体间的联系是1:n，则在n端的实体类型转换成的关系模式中加入1端实体类型的键和联系类型的属性。
- 若实体间的联系是m:n，则将**联系类型也转换成关系模式**，其属性为两端实体类型的键加上联系类型的属性，而键为两端实体键的组合。

三个以上实体间的一个多元联系



**例题：**

在数据库逻辑结构的设计中，将E-R模型转为关系模型应遵循相关的原则。对于三个不同实体集和它们之间的多对多联系m: n: p，最少课转换为（）个关系模式。

![例题](./03_%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F.assets/ER%E5%9B%BE%E4%BE%8B%E9%A2%98.png)

A、B、C加上中间的联系，一共四个



## 4. 关系代数

并、交、差、笛卡尔积、投影、选择、联结

<img src="./03_%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F.assets/%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF.png" style="zoom:67%;" />

<img src="./03_%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F.assets/连接.png" style="zoom:67%;" />





